<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <title>友谊的小船</title>
    <link rel="shortcut icon" href="public/img/favicon.ico">
    <link rel="stylesheet" href="public/css/bootstrap.min.css">
    <link rel="stylesheet" href="public/css/boat_upload.css">
</head>
<body>
<div class="container">
    <div class="boat-title">
        <img src="public/img/boat/boat_title.png"/>
    </div>

    <div class="card-container-two-background">

        <div class="card-container-two">
            <div class="btn-img-add">
                <input type="file" id="file" accept="image/*" onchange="clip();">
            </div>
            <div class="btn-img-add1">
                <input type="file" id="file1" accept="image/*" onchange="clip1();">
            </div>
            <div id="plan">
                <canvas id="myCanvas"></canvas>
            </div>
            <div id="plan1">
                <canvas id="myCanvas1"></canvas>
            </div>
            <img id="upload-btn" class="add gifjs1" src="public/img/boat/boat_avatar_wo.png">
            <img id="upload-baby" class="add-baby gifjs2" src="public/img/boat/boat_avatar_ta.png">
            <div class="card-back">
                <img class="boat_gif_invisible" src="public/img/boat/boat_gif_tm.png">

                <img class="render" src="http://yingshi.duelgenji.com/res/boat_gif_default_1.png?imageMogr2/thumbnail/500x/strip">
            </div>
            <input type="hidden" id="imgUrl" style="opacity: 0;position: fixed;bottom: -100px">
            <input type="hidden" id="imgUrl1" style="opacity: 0;position: fixed;bottom: -100px">
        </div>


    </div>

    <div style="margin-top: 50px" class="button-content">
        <div class="btn-img" id="save">
            <img src="public/img/boat/btn_save.png">
        </div>
        <div class="btn-img" id="reset">
            <img src="public/img/boat/btn_reset.png">
        </div>
    </div>

    <div style="height: 50px;width: 100%"></div>

    <div class="boat-bottom">
        <div id="want_play" class="want-play">
            <span class="want-span">>>> </span><span class="want-play-span">我也要玩</span>
        </div>
    </div>

</div>

<!-- Modal -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-clip" role="document">
        <div class="modal-dialog " role="document" style="width:100%;height: 100%; padding: 0; margin: 0">
            <div id="clipArea" class="center" style="height: 100%"></div>
            <img src="" fileName="" id="hit" style="display:none; z-index: 9">
        </div>
        <div class="clip-button button-content">
            <div class="btn-img close-modal"  data-dismiss="modal">
                <img src="public/img/boat/btn_return.png">
            </div>
            <div id="clipBtn" class="btn-img upload-modal">
                <img src="public/img/boat/btn_upload.png">
            </div>
        </div>
        <div class="clip-message">双指捏合或拖动图片以选取头像</div>
    </div>
</div>

<!-- Modal -->
<div class="modal" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-clip" role="document">
        <div class="modal-dialog " role="document" style="width:100%;height: 100%; padding: 0; margin: 0">
            <div id="clipArea1" class="center" style="height: 100%"></div>
            <img src="" fileName="" id="hit1" style=" display:none; z-index: 9">
        </div>
        <div class="clip-button button-content">
            <div class="btn-img close-modal"  data-dismiss="modal">
                <img src="public/img/boat/btn_return.png">
            </div>
            <div id="clipBtn1" class="btn-img upload-modal">
                <img src="public/img/boat/btn_upload.png">
            </div>
        </div>
        <div class="clip-message">双指捏合或拖动图片以选取头像</div>
    </div>
</div>

<!-- Modal -->
<div class="modal my-model" id="textModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 100%;height: 100%;margin: 0">
        <div class="modal-content center" style="height: 170px;width: 250px;background-color: #C8EAFA;border:none;">
            <div class="my-modal-body" id="my-message"
                 style="padding: 30px 10px;text-align: center;font-size: 18px;height: 110px;color: black">
                提交中,请稍后...
            </div>
            <div class="my-modal-footer">
                <button type="button" class="btn btn-default"
                        style="display: block; margin: 0 99px;border: none;background-color: #7ECEF4;color:#4f3c00 "
                        data-dismiss="modal">确定
                </button>
            </div>
        </div>
    </div>
</div>


<script src="public/js/jquery.min.js"></script>
<script src="public/js/bootstrap.min.js"></script>
<script src="public/js/sonic.js"></script>
<script src="public/js/hammer.js"></script>
<script src="public/js/iscroll-zoom.js"></script>
<script src="public/js/jquery.photoClip.js"></script>
<script src="public/js/common.js"></script>
<script src="public/js/boat_upload.js"></script>

<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="public/js/wxconfig.js"></script>
<script src="public/js/hashes.min.js"></script>
<script src="public/js/gif.js"></script>
<script>


    $(document).ready(function(){
        var current_url = location.href;
        upload_init();
        $.ajax({
            url:commonUrl+"wx/getTicket",
            type:"GET",
            success:function(data){
                var SHA1 = new Hashes.SHA1;
                var appId =  "wxa572b73e050e1bb4";
                var timestamp =  parseInt(new Date().getTime()/1000);
                var nonceStr =  createNonceStr();
                var jsapi_ticket = data.token;
                var string = "jsapi_ticket="+jsapi_ticket+"&noncestr="+nonceStr+"&timestamp="+timestamp+"&url="+current_url;
                var signature = SHA1.hex(string);
                wx.config({
                    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                    appId: appId, // 必填，公众号的唯一标识
                    timestamp: timestamp , // 必填，生成签名的时间戳
                    nonceStr: nonceStr, // 必填，生成签名的随机串
                    signature: signature,// 必填，签名，见附录1
                    jsApiList: ["onMenuShareTimeline","onMenuShareAppMessage"] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
                });
            }
        });
        wx.ready(function () {
            wx.onMenuShareAppMessage({
                title: '友谊的小船要翻了，赶紧来拯救！', // 分享标题
                link: current_url,
                desc: "友谊的小船说翻就翻，大家都在救，我也要去！",
                imgUrl: 'http://o84r72kbf.bkt.clouddn.com/boat/20160606161311723', // 分享图标
                success: function () {
                }
            });
            wx.onMenuShareTimeline({
                title: '友谊的小船要翻了，赶紧来拯救！', // 分享标题
                link: current_url, // 分享链接
                desc: "友谊的小船说翻就翻，大家都在救，我也要去！",
                imgUrl: 'http://o84r72kbf.bkt.clouddn.com/boat/20160606161311723', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                }
            });
        });
    });


</script>
</body>
</html>